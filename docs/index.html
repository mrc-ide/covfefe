<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation of falciparum genetic data • covfefe</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Simulation of falciparum genetic data">
<meta property="og:description" content="More about what it does (maybe more than one line)
    Use four spaces when indenting paragraphs within the Description.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">covfefe</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="covfefe" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#covfefe" class="anchor"></a>covfefe</h1></div>

<p>The R package <em>covfefe</em> performs Computational Validation For Estimating Falciparum Epidemiology (ahem). More specifically, it provides a flexible framework for simulating genetic data from <em>P. falciparum</em> transmission models.</p>
<p>We start with data on infection histories - i.e. who became infected when, who did this infection originate from, when did this episode recover, etc. We then specify a subset of samples that we are interested in - for example, 100 individuals at day 365. <em>covfefe</em> then prunes the infection history data down to a reduced set that contains only the events that directly impact on the samples that we are interested in. Often the number of sampled hosts is far smaller than the total infected population, or perhaps sampling only occurs at a few time points, meaning the pruned infection history can be <em>much</em> smaller than the complete infection history. Finally, <em>covfefe</em> simulates genetic data from the pruned infection history and from a set of user-defined parameters that specify the genetic model, for example the recombination rate and the number of loci.</p>
<p>By using the infection history as the starting point we ensure that multiple epidemiological models can be plugged into the same tool. Any malaria transmission model that generates infection history data in the format required by <em>covfefe</em> can be used to simulate genetic data, and this format has been designed to be flexible enough to encompass a wide range of models. As a starting point, <em>covfefe</em> contains a simple individual-based model that simulates malaria transmission in multiple demes (partially isolated subpopulations), with or without migration between demes.</p>
<p><strong>This package is still in development</strong>, meaning methods are likely to change in the near future. That being said, here are instructions on how to install and run <em>covfefe</em> as it currently stands.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><em>covfefe</em> relies on the Rcpp package, which requires the following OS-specific steps:</p>
<ul>
<li>Windows
<ul>
<li>Download and install the appropriate version of <a href="https://cran.rstudio.com/bin/windows/Rtools/">Rtools</a> for your version of R. On installation, ensure you check the box to arrange your system PATH as recommended by Rtools</li>
</ul>
</li>
<li>Mac OS X
<ul>
<li>Download and install <a href="http://itunes.apple.com/us/app/xcode/id497799835?mt=12">XCode</a>
</li>
<li>Within XCode go to Preferences : Downloads and install the Command Line Tools</li>
</ul>
</li>
<li>Linux (Debian/Ubuntu)
<ul>
<li>
<p>Install the core software development utilities required for R package development as well as LaTeX by executing</p>
<div class="sourceCode"><pre class="sourceCode R"><code class="sourceCode r"><span class="st">```</span>
<span class="dt">sudo apt-get install r-base-dev texlive-full</span>
<span class="st">```</span></code></pre></div>
</li>
</ul>
</li>
</ul>
<p>Next, ensure that you have devtools installed by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>)</code></pre></div>
<p>Finally, install the <em>covfefe</em> package directly from GitHub by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"mrc-ide/covfefe"</span>)
<span class="kw">library</span>(covfefe)</code></pre></div>
</div>
<div id="example-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#example-analysis" class="anchor"></a>Example analysis</h2>
<p>We start by creating a covfefe project. This project will hold all inputs and outputs used by the package, and is a convenient way of keeping everything we need in one place.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myproj &lt;-<span class="st"> </span><span class="kw"><a href="reference/covfefe_project.html">covfefe_project</a></span>()</code></pre></div>
<p>Running <code>names(myproj)</code> we can see all the elements that make up a <em>covfefe</em> project, including parameters, distributions, etc. We will talk about each of these elements later on.</p>
<p>Next we need some data on infection histories. For convenience, we will use the in-built individual-based model with default settings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mysim &lt;-<span class="st"> </span><span class="kw"><a href="reference/sim_indiv.html">sim_indiv</a></span>()</code></pre></div>
<p>Again, running <code>names(mysim)</code> we can see the individual elements of <code>mysim</code>, including <code>H</code> - the human population size in each deme, <code>daily_counts</code> - the number of susceptible vs. singly-infected vs. doubly-infected (and so on) individuals on each day, and <code>infection_history</code> - the main output we are interest in. For those who want to understand the infection history format, details can be found <em>here</em> (<strong>TODO - link to format</strong>).</p>
<p>We continue by loading the infection history into our project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myproj &lt;-<span class="st"> </span><span class="kw"><a href="reference/assign_infection_history.html">assign_infection_history</a></span>(myproj, mysim$infection_history)</code></pre></div>
<p>Next, we need to specify how many human hosts we want to sample from. We do this using a simple matrix or data frame with three columns: column 1 gives the time of sampling, column 2 gives the deme that we are sampling from, and column 3 gives the number of hosts (hosts are drawn at random from the pool of blood stage individuals at that point in time). Note that in column 3, a value of -1 indicates that all blood stage hosts should be sampled. For this example we will sample at day 100 and day 365, in a single deme (we only have one deme), and drawing all hosts at the first time point and 100 hosts at the second time point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">365</span>), <span class="dt">demes =</span> <span class="dv">1</span>, <span class="dt">hosts =</span> <span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">100</span>))</code></pre></div>
<p>When we come to load this data into our project there are a few other arguments to be aware of. First, we must specify</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myproj &lt;-<span class="st"> </span><span class="kw"><a href="reference/sample_hosts.html">sample_hosts</a></span>(myproj, samp, demes, <span class="dt">recover_pop_counts =</span> <span class="ot">FALSE</span>, <span class="dt">max_infections =</span> <span class="dv">5</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=covfefe">https://​cloud.r-project.org/​package=covfefe</a>
</li>
<li>Report a bug at <br><a href="NA">NA</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Bob Verity <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/mrc-ide/covfefe"><img src="https://travis-ci.org/mrc-ide/covfefe.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/mrc-ide/covfefe"><img src="https://ci.appveyor.com/api/projects/status/github/mrc-ide/covfefe?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/github/mrc-ide/covfefe?branch=master"><img src="https://img.shields.io/codecov/c/github/mrc-ide/covfefe/master.svg" alt="Coverage Status"></a></li>
<li><a href="https://mrc-ide.github.io/covfefe/"><img src="https://img.shields.io/badge/documentation-click%20here!-blue.svg" alt="Documentation"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
